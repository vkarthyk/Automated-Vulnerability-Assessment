	<ruby>
	framework.db.hosts.each do |h|
	       h.services.each do |serv|
	 
		if serv.port == 445 and h.os_flavor =~/XP|.NET Server|2003/i
				next if (serv.port != 445)
				print_good("#{h.address} seems to be Windows #{h.os_flavor}...")
				self.run_single("use exploit/windows/smb/ms08_067_netapi")
				print_good("Running ms08_067_netapi check against #{h.address}")
				self.run_single("set RHOST #{h.address}")
				self.run_single("check")
		   
		elsif serv.port == 5900 and h.os_name =~/Linux/i
				next if (serv.port != 5900)
				print_good("#{h.address} seems to be Linux #{h.os_flavor}...")
				self.run_single("use auxiliary/scanner/vnc/vnc_none_auth")
				print_good("Running VNC no auth check against #{h.os_flavor}")
				self.run_single("set RHOSTS #{h.address}")
				self.run_single("run")
		 
		else
			end
	    end
	end
	</ruby>
